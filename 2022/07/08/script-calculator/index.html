<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ScriptCalculator - 不只是程序员的计算器 | i&#39;m iwill</title>
  <meta name="author" content="iwill">
  
  <meta name="description" content="ScriptCalculator: https://iwill.im/static/ScriptCalculator.htmlGitHub Repo: https://github.com/iwill/ScriptCalculator

ScriptCalculator 是我为了满足个人需求开发的一款计算器。
先看效果，假设某同学月薪 10w，用 ScriptCalculator 计算一下他的税后收入（为了便于演示，这里不考虑五险一金、绩效、ESPP、加班费、餐补等），如图：


查看计算脚本 or 我也算算 👀">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="ScriptCalculator - 不只是程序员的计算器"/>
  <meta property="og:site_name" content="i&#39;m iwill"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="i&#39;m iwill" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">i&#39;m iwill</a></h1>
  <h2><a href="/">https://iwill.im/</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">About</a></li>
    
      <li><a href="/atom.xml">RSS</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2022-07-08T02:20:00.000Z"><a href="/2022/07/08/script-calculator/">2022-07-08</a></time>
      
      
  
    <h1 class="title">ScriptCalculator - 不只是程序员的计算器</h1>
  

    </header>
    <div class="entry">
      
        <blockquote>
<p>ScriptCalculator: <a href="https://iwill.im/static/ScriptCalculator.html">https://iwill.im/static/ScriptCalculator.html</a><br /><br>GitHub Repo: <a target="_blank" rel="noopener" href="https://github.com/iwill/ScriptCalculator">https://github.com/iwill/ScriptCalculator</a></p>
</blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html">ScriptCalculator</a> 是我为了满足个人需求开发的一款计算器。</p>
<p>先看效果，假设某同学月薪 10w，用 ScriptCalculator 计算一下他的税后收入（为了便于演示，这里不考虑五险一金、绩效、ESPP、加班费、餐补等），如图：</p>
<p><img src="/images/script-calculator.png" alt="script-calculator.png"></p>
<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22decimalPlaces%22%3A4%2C%22script%22%3A%22%23%20Quick%20Start%5Cn%5Cn1%20%2B%202%5Cn*%203%5Cn*%2080%25%5Cn%5Cn10%20-%20%24%5Cn%241%20%2F%202%5Cn%5Cna%3A%201%5Cnb%3A%202%5Cna%20%2B%20b%5Cn%5Cnadd(x%2C%20y)%3A%20x%20%2B%20y%5Cnadd(1%2C%202)%5Cnadd(3%2C%204)%5Cn%5Cn%5Cn%23%20%E4%B8%AA%E7%A8%8E%E8%AE%A1%E7%AE%97%5Cn%5Cn%2F%2F%20%E5%81%87%E8%AE%BE%E6%9F%90%E5%90%8C%E5%AD%A6%E6%9C%88%E8%96%AA%2010w%EF%BC%8C%E7%94%A8%20ScriptCalculator%20%E8%AE%A1%E7%AE%97%E4%B8%80%E4%B8%8B%E4%BB%96%E7%9A%84%E7%A8%8E%E5%90%8E%E6%94%B6%E5%85%A5%5Cn%2F%2F%20%E4%B8%BA%E4%BA%86%E4%BE%BF%E4%BA%8E%E6%BC%94%E7%A4%BA%EF%BC%8C%E8%BF%99%E9%87%8C%E4%B8%8D%E8%80%83%E8%99%91%E7%BB%A9%E6%95%88%E5%B7%A5%E8%B5%84%E3%80%81%E5%8A%A0%E7%8F%AD%E8%B4%B9%E3%80%81%E9%A4%90%E8%A1%A5%E3%80%81ESPP%E3%80%81%E4%BA%94%E9%99%A9%E4%B8%80%E9%87%91%E7%AD%89%5Cn%5Cn%2F%2F%20%E7%BA%B3%E7%A8%8E%E9%87%91%E9%A2%9D%20%3D%20%E7%A8%8E%E5%89%8D%E6%94%B6%E5%85%A5%20*%20%E9%80%82%E5%BA%94%E7%A8%8E%E7%8E%87%20-%20%E9%80%9F%E7%AE%97%E6%89%A3%E9%99%A4%E6%95%B0%5Cn%2F%2F%20%E8%B6%85%E8%BF%87%20960000%20%E7%9A%84%E9%83%A8%E5%88%86%E9%80%82%E5%BA%94%E7%A8%8E%E7%8E%87%2045%25%E3%80%81%E9%80%9F%E7%AE%97%E6%89%A3%E9%99%A4%E6%95%B0%20181920%5Cn%2F%2F%20https%3A%2F%2Fjcc.bjmu.edu.cn%2Fdocs%2F20220104113607391688.pdf%5Cn%5Cnw%3A%2010000%20%2F%2F%20%E8%BF%99%E4%B8%AA%20w%20%E6%98%AF%E4%B8%AA%E5%8F%98%E9%87%8F%EF%BC%8C%E4%BB%A3%E8%A1%A8%201%20%E4%B8%87%5Cn%5Cn10%20*%20w%20%2F%2F%20%E6%AF%8F%E6%9C%88%E8%96%AA%E8%B5%84%5Cntatal%3A%20%20%20%20%20%20%20%20%20%20%20*%2012%20%2F%2F%20%E6%AF%8F%E5%B9%B4%E6%94%B6%E5%85%A5%5Cntax%3A%20*%2045%25%20-%20181920%20%2F%2F%20%E7%BC%B4%E7%BA%B3%E4%B8%AA%E7%A8%8E%5Cn%5Cntatal%20-%20%24%20%2F%2F%20%E7%A8%8E%E5%90%8E%E6%94%B6%E5%85%A5%5Cn%2F%20w%20%2F%2F%20%E5%8D%95%E4%BD%8D%E4%B8%87%E5%85%83%5Cn%5Cntax%20%2F%20tatal%20%25%25%20%2F%2F%20%E5%AE%9E%E9%99%85%E7%BA%B3%E7%A8%8E%E6%AF%94%E4%BE%8B%5Cn%5Cn%2F%2F%20%E6%88%96%E8%80%85%E5%8F%AF%E4%BB%A5%E5%AE%9A%E4%B9%89%E4%B8%A4%E4%B8%AA%E5%85%AC%E5%BC%8F%5Cngot(salary%2C%20rate%2C%20qcd)%3A%20salary%20*%2012%20*%20(1%20-%20rate)%20%2B%20qcd%20%2F%2F%20%E7%A8%8E%E5%90%8E%E6%94%B6%E5%85%A5%5Cntax(salary%2C%20rate%2C%20qcd)%3A%20salary%20*%2012%20*%20rate%20-%20qcd%20%2F%2F%20%E7%BC%B4%E7%BA%B3%E4%B8%AA%E7%A8%8E%5Cn%5Cn%2F%2F%20%E4%B8%8A%E9%9D%A2%E4%BE%8B%E5%AD%90%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BB%A3%E5%85%A5%E5%85%AC%E5%BC%8F%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E7%9B%B8%E5%90%8C%E7%BB%93%E6%9E%9C%5Cngot(10%20*%20w%2C%2045%25%2C%20181920)%5Cntax(10%20*%20w%2C%2045%25%2C%20181920)%5Cn%5Cn%2F%2F%20%E5%86%8D%E8%AF%95%E8%AF%95%E6%9C%88%E8%96%AA%201w%20%E7%9A%84%5Cngot(1%20*%20w%2C%2010%25%2C%202520)%5Cntax(1%20*%20w%2C%2010%25%2C%202520)%5Cn%5Cn%2F%2F%20%E6%9B%B4%E5%A4%9A%E5%A5%BD%E7%94%A8%E7%9A%84%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D%E7%9C%8B%E8%BF%99%E9%87%8C%20%F0%9F%91%89%F0%9F%8F%BF%20https%3A%2F%2Fiwill.im%2F2022%2F07%2F08%2Fscript-calculator%2F%5Cn%5Cn%22%7D">查看计算脚本 or 我也算算 👀</a></p>
</blockquote>
<span id="more"></span>

<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>我最初的需求是希望能保留计算过程，能展示中间结果，能随时修改数据和计算逻辑、计算结果同步更新，必要的地方可以加备注。似乎很正常的需求，但找了好久就没发现哪个计算器能满足，所以经常要写代码计算。</p>
<p>最常用的是在 Chrome 控制台写 JavaScript，好处是随手就能拿过来写，但问题是输入不方便、输出结果也不直观，还要在文本编辑器和控制台之间来回拷贝代码和计算结果。偶尔也用过 Swift Playgrounds，左边写代码、右边看结果的方式很友好，但代码里多少还是夹杂了很多数据之外的东西，还要操心数据类型，而且 Xcode 也不是很轻量。</p>
<p>所以，终究是要靠自己。</p>
<h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><p>ScriptCalculator 基于网页，核心思想是解析输入的计算脚本，通过预处理变成 JavaScript 代码，然后用 <code>eval()</code> 运行代码完成计算，充分地利用了 JavaScript 语言的多种特性。</p>
<p>先是实现了基础运算，后来边用边迭代，逐步支持了：</p>
<ul>
<li>比较运算、逻辑运算、布尔类型</li>
<li>各种进制以及位运算</li>
<li>百分数的输入、输出</li>
<li>自定义变量和函数<ul>
<li>函数支持递归调用</li>
<li>函数支持 RORO 形式参数</li>
</ul>
</li>
<li>JavaScript 表达式和代码块</li>
<li>折行和注释</li>
<li>通过 URL 分享计算脚本</li>
</ul>
<p>等等等等，非常丰富的特性。</p>
<p>页面样式模仿 Swift Playgrounds，左边输入的计算脚本、右对齐，右边展示计算结果、左对齐，这样算式和结果紧紧地靠在一起，比 Swift Playgrounds 看起来更友好。</p>
<p>此外，还有很多页面上看不见的强大功能。完整的计算脚本、设置项等都会序列化到 URL 里，前进、后退、刷新、关闭再重开、备份或转发的 URL 粘贴到浏览器等操作，都可以 100% 还原 —— 连包括文本选中状态都还原。配合上精心调教过的复制、粘贴、撤销、重做、大小写切换等，可以让你用起来如行云流水般自在。</p>
<p>最终，语法简洁、功能强大、使用方便，（至少我自己）用起来非常顺手，舒坦！</p>
<p>这里有 <a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%23%20%E5%8A%9F%E8%83%BD%E6%BC%94%E7%A4%BA%5Cn%5Cn%23%23%20%E5%9F%BA%E6%9C%AC%E8%BF%90%E7%AE%97%5Cn%5Cn1%20%2B%202%5Cn*%203%5Cn%2F%204%5Cn%5Cn%241%20%2F%202%5Cn%2F%2F%20%24n%20%E8%A1%A8%E7%A4%BA%E7%AC%AC%20n%20%E4%B8%AA%E7%BB%93%E6%9E%9C%5Cn%5Cn10%20-%20%24%5Cn%2F%2F%20%24%20%E8%A1%A8%E7%A4%BA%E4%B8%8A%E4%B8%80%E4%B8%AA%E7%BB%93%E6%9E%9C%5Cn%5Cn%F0%9F%91%86%F0%9F%8F%BB%20%2B%20%F0%9F%91%86%F0%9F%8F%BF%5Cn%2F%2F%20%F0%9F%91%86%F0%9F%8F%BF%20%E4%B9%9F%E8%A1%8C%EF%BC%8C%E8%80%8C%E4%B8%94%E4%BB%BB%E4%BD%95%E8%82%A4%E8%89%B2%E9%83%BD%E8%A1%8C%5Cn%5Cn%23%20%E7%99%BE%E5%88%86%E6%95%B0%5Cn%5Cn10%25%5Cn1%20%2B%2010%25%5Cn%5Cn%23%23%20%E7%BB%93%E6%9E%9C%E4%BB%A5%E7%99%BE%E5%88%86%E6%95%B0%E5%BD%A2%E5%BC%8F%E5%B1%95%E7%A4%BA%EF%BC%8C%E4%B8%8D%E5%BD%B1%E5%93%8D%E5%AE%9E%E9%99%85%E7%BB%93%E6%9E%9C%5Cn%5Cn0.1%20%25%25%5Cn*%202%20%20%20%5Cn%25%25%5Cn%5Cn%23%23%20%E4%BA%8C%E3%80%81%E5%85%AB%E3%80%81%E5%8D%81%E3%80%81%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%5Cn%5Cn0b10%5Cn0o10%5Cn10%5Cn0x10%5Cn%5Cn%23%23%20%E7%BB%93%E6%9E%9C%E8%BD%AC%E4%BA%8C%E8%87%B3%E4%B8%89%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%5Cn%5Cn32%20%232%20%5Cn%238%20%5Cn%2310%5Cn%2316%5Cn%2332%5Cn%2336%5Cn%24%5Cn%5Cn%23%23%20%E4%BD%8D%E8%BF%90%E7%AE%97%5Cn%5Cn0b01%20%7C%200b10%20%232%5Cn0b10%20%26%200b11%20%232%5Cn~0b01%20%232%5Cn0b01%20%5E%200b11%20%232%5Cn%5Cn1%20%3C%3C%20%200%20%232%5Cn1%20%3C%3C%20%201%20%232%5Cn1%20%3C%3C%20%202%20%232%5Cn1%20%3C%3C%20%204%20%232%5Cn1%20%3C%3C%20%208%20%232%5Cn1%20%3C%3C%2016%20%232%5Cn1%20%3C%3C%2032%20%232%5Cn%5Cn%23%23%20%E5%86%85%E7%BD%AE%E5%B8%B8%E9%87%8F%5Cn%5Cn%2F%2F%20%E8%87%AA%E7%84%B6%E5%B8%B8%E6%95%B0%E3%80%81%E5%9C%86%E5%91%A8%E7%8E%87%E3%80%81%E9%BB%84%E9%87%91%E5%88%86%E5%89%B2%E6%AF%94%5CnE%5CnPI%5CnGR%5Cn%5Cn%23%23%20%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%5Cn%5Cn%2F%2F%20%E6%9C%80%E5%B0%8F%2F%E5%A4%A7%E5%80%BC%E3%80%81%E4%B9%98%E6%96%B9%E3%80%81%E5%BC%80%E5%B9%B3%E6%96%B9%5Cnmin(max(1%2C%202)%2C%203)%5Cnpow(2%2C%2010)%5Cn%3D%3D%202%20**%2010%5Cnsqrt(1024)%5Cn%5Cn%2F%2F%20%E5%9B%9B%E8%88%8D%E4%BA%94%E5%85%A5%E3%80%81%E5%90%91%E4%B8%8A%2F%E5%90%91%E4%B8%8B%E5%8F%96%E6%95%B4%EF%BC%8C%E6%94%AF%E6%8C%81%E6%8C%87%E5%AE%9A%E5%B0%8F%E6%95%B0%E7%82%B9%E5%90%8E%2F%E5%89%8D%E4%BD%8D%E6%95%B0%5Cn_666%3A%202000%20%2F%203%5Cnround(_666%2C%20%203)%5Cnfloor(_666%2C%20%202)%5Cnceil(_666%20%2F%202%2C%20%201)%5Cnround(_666%2C%20%200)%5Cnround(_666)%20%20%20%20%5Cnround(_666%2C%20-1)%5Cnround(_666%2C%20-2)%5Cn%5Cn%23%23%20%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F%5Cn%5Cna%3A%201%5Cnb%3A%202%5Cna%20%2B%20b%5Cn%5Cn%23%23%20%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0%5Cn%5Cnadd(a%2C%20b)%3A%20a%20%2B%20b%5Cnadd(3%2C%204)%5Cn%5Cn%2F%2F%20%E6%94%AF%E6%8C%81%E6%9B%B4%E5%85%B7%E8%AF%AD%E4%B9%89%E5%8C%96%E7%9A%84%20RORO%20%E5%BD%A2%E5%BC%8F%E5%8F%82%E6%95%B0%5Cn%2F%2F%20%E8%A1%8C%E5%B0%BE%E5%8A%A0%20%60%5C%5C%60%20%E5%8F%AF%E4%BB%A5%E6%8A%98%E8%A1%8C%5Cnadd(%7B%20a%2C%20b%20%7D)%3A%20%5C%5C%5Cna%20%2B%20b%5Cnadd(%7B%20a%3A%204%2C%20b%3A%205%20%7D)%5Cn%5Cn%22%7D">丰富的功能演示</a>，不喜欢看文档的可以直接操练起来。</p>
<h2 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h2><h3 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h3><p>支持 <code>+</code>、<code>-</code>、<code>*</code>、<code>/</code>、<code>%</code>（取余）、<code>**</code>（幂运算）、<code>(</code> 和 <code>)</code> 等基础运算</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   <span class="number"> 2 </span>+<span class="number"> 4 </span>//<span class="number"> 6 </span></span><br><span class="line">      -<span class="number"> 3 </span>//<span class="number"> 3 </span></span><br><span class="line">      *<span class="number"> 4 </span>// 12</span><br><span class="line">      /<span class="number"> 2 </span>//<span class="number"> 6 </span></span><br><span class="line">      %<span class="number"> 4 </span>//<span class="number"> 2 </span></span><br><span class="line">     **<span class="number"> 2 </span>//<span class="number"> 4 </span></span><br><span class="line">* (1 + 2) // 12</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20%20%20%202%20%2B%204%20%2F%2F%206%20%5Cn%20%20%20%20%20%20-%203%20%2F%2F%203%20%5Cn%20%20%20%20%20%20*%204%20%2F%2F%2012%5Cn%20%20%20%20%20%20%2F%202%20%2F%2F%206%20%5Cn%20%20%20%20%20%20%25%204%20%2F%2F%202%20%5Cn%20%20%20%20%20**%202%20%2F%2F%204%20%5Cn*%20(1%20%2B%202)%20%2F%2F%2012%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A112%2C%22end%22%3A112%7D%7D">try it yourself</a></p>
</blockquote>
<details>
<summary>TL;DR: 不常用内容，点击展开。</summary>

<p>支持 <code>&lt;</code>、<code>&lt;=</code>、<code>&gt;</code>、<code>&gt;=</code>、<code>==</code> 和 <code>!=</code> 等比较运算</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">1</span> &lt;  <span class="number">2</span> <span class="regexp">//</span> true </span><br><span class="line">    <span class="number">2</span> &lt;= <span class="number">1</span> <span class="regexp">//</span> false</span><br><span class="line">    <span class="number">2</span> &gt;  <span class="number">1</span> <span class="regexp">//</span> true </span><br><span class="line">    <span class="number">2</span> &gt;= <span class="number">2</span> <span class="regexp">//</span> true </span><br><span class="line"><span class="number">1</span> + <span class="number">1</span> == <span class="number">2</span> <span class="regexp">//</span> true </span><br><span class="line"><span class="number">1</span> + <span class="number">1</span> != <span class="number">3</span> <span class="regexp">//</span> true </span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20%20%20%201%20%3C%20%202%20%2F%2F%20true%20%5Cn%20%20%20%202%20%3C%3D%201%20%2F%2F%20false%5Cn%20%20%20%202%20%3E%20%201%20%2F%2F%20true%20%5Cn%20%20%20%202%20%3E%3D%202%20%2F%2F%20true%20%5Cn1%20%2B%201%20%3D%3D%202%20%2F%2F%20true%20%5Cn1%20%2B%201%20!%3D%203%20%2F%2F%20true%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A120%2C%22end%22%3A120%7D%7D">try it yourself</a></p>
</blockquote>
<p>支持布尔类型 <code>&amp;&amp;</code>、<code>||</code>、<code>!</code> 和 <code>?:</code> 等逻辑运算</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> || <span class="number">1</span> <span class="regexp">//</span> <span class="number">1</span></span><br><span class="line"><span class="number">0</span> &amp;&amp; <span class="number">1</span> <span class="regexp">//</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> || <span class="number">0</span> <span class="regexp">//</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> &amp;&amp; <span class="number">0</span> <span class="regexp">//</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    !<span class="number">0</span> <span class="regexp">//</span> true</span><br><span class="line"></span><br><span class="line"><span class="number">0</span> &gt; <span class="number">1</span> ? <span class="number">1</span> : <span class="number">2</span> <span class="regexp">//</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%220%20%7C%7C%201%20%2F%2F%201%5Cn0%20%26%26%201%20%2F%2F%200%5Cn1%20%7C%7C%200%20%2F%2F%201%5Cn1%20%26%26%200%20%2F%2F%200%5Cn%5Cn%20%20%20%20!0%20%2F%2F%20true%5Cn%5Cn0%20%3E%201%20%3F%201%20%3A%202%20%2F%2F%202%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A84%2C%22end%22%3A84%7D%7D">try it yourself</a></p>
</blockquote>
</details>

<h3 id="百分数"><a href="#百分数" class="headerlink" title="百分数"></a>百分数</h3><p>支持直接输入百分数：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">10</span>%       //     <span class="number">0</span>.<span class="number">1</span> ==  <span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">10</span> %      //     <span class="number">0</span>.<span class="number">1</span> ==  <span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">10</span>% + <span class="number">1</span>   // <span class="number">0</span>.<span class="number">1</span> + <span class="number">1</span> ==  <span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">10</span>% % <span class="number">1</span>   // <span class="number">0</span>.<span class="number">1</span> % <span class="number">1</span> ==  <span class="number">0</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">10</span>% - <span class="number">7</span>   // <span class="number">0</span>.<span class="number">1</span> - <span class="number">7</span> == -<span class="number">6</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">10</span> % (-<span class="number">7</span>) //  <span class="number">10</span> % <span class="number">7</span> ==  <span class="number">3</span>  </span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%2210%25%20%20%20%20%20%20%20%2F%2F%20%20%20%20%200.1%20%3D%3D%20%200.1%5Cn10%20%25%20%20%20%20%20%20%2F%2F%20%20%20%20%200.1%20%3D%3D%20%200.1%5Cn10%25%20%2B%201%20%20%20%2F%2F%200.1%20%2B%201%20%3D%3D%20%201.1%5Cn10%25%20%25%201%20%20%20%2F%2F%200.1%20%25%201%20%3D%3D%20%200.1%5Cn10%25%20-%207%20%20%20%2F%2F%200.1%20-%207%20%3D%3D%20-6.9%5Cn10%20%25%20(-7)%20%2F%2F%20%2010%20%25%207%20%3D%3D%20%203%20%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A174%2C%22end%22%3A174%7D%7D">try it yourself</a></p>
</blockquote>
<p>| 需要注意百分号与取余运算符的使用差异</p>
<p>支持结果以百分数形式展示：</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">0.1</span> <span class="meta">%</span><span class="meta">%</span> <span class="comment">// 10% </span></span><br><span class="line">* <span class="number">2.4</span>    <span class="comment">// 0.24</span></span><br><span class="line">      <span class="meta">%</span><span class="meta">%</span> <span class="comment">// 24% </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20%200.1%20%25%25%20%2F%2F%2010%25%20%5Cn*%202.4%20%20%20%20%2F%2F%200.24%5Cn%20%20%20%20%20%20%25%25%20%2F%2F%2024%25%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A51%2C%22end%22%3A51%7D%7D">try it yourself</a></p>
</blockquote>
<h3 id="进制及位运算"><a href="#进制及位运算" class="headerlink" title="进制及位运算"></a>进制及位运算</h3><details>
<summary>TL;DR: 不常用内容，点击展开。</summary>

<p>支持输入二、八、十、十六进制数字，结果默认以十进制形式展示：</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0b10</span>   // <span class="number">2</span> </span><br><span class="line"><span class="number">0o10</span>   // <span class="number">8</span> </span><br><span class="line">  <span class="number">10</span>   // <span class="number">10</span></span><br><span class="line"><span class="number">0x10</span>   // <span class="number">16</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%220b10%20%20%20%2F%2F%202%20%5Cn0o10%20%20%20%2F%2F%208%20%5Cn%20%2010%20%20%20%2F%2F%2010%5Cn0x10%20%20%20%2F%2F%2016%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A52%2C%22end%22%3A52%7D%7D">try it yourself</a></p>
</blockquote>
<p>支持结果以二至三十六进制形式展示：</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里每一行都是获取上一行的结果、转换进制展示</span></span><br><span class="line"><span class="number">32</span> <span class="meta">#2  <span class="comment">// 0b100000</span></span></span><br><span class="line">   <span class="meta">#8  <span class="comment">// 0o40    </span></span></span><br><span class="line">   <span class="meta">#10 <span class="comment">// 32      </span></span></span><br><span class="line">   <span class="meta">#16 <span class="comment">// 0x20    </span></span></span><br><span class="line">   <span class="meta">#32 <span class="comment">// 10      </span></span></span><br><span class="line">   <span class="meta">#36 <span class="comment">// W       </span></span></span><br><span class="line"> $     <span class="comment">// 32      </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%2F%2F%20%E8%BF%99%E9%87%8C%E6%AF%8F%E4%B8%80%E8%A1%8C%E9%83%BD%E6%98%AF%E8%8E%B7%E5%8F%96%E4%B8%8A%E4%B8%80%E8%A1%8C%E7%9A%84%E7%BB%93%E6%9E%9C%E3%80%81%E8%BD%AC%E6%8D%A2%E8%BF%9B%E5%88%B6%E5%B1%95%E7%A4%BA%5Cn32%20%232%20%20%2F%2F%200b100000%5Cn%20%20%20%238%20%20%2F%2F%200o40%20%20%20%20%5Cn%20%20%20%2310%20%2F%2F%2032%20%20%20%20%20%20%5Cn%20%20%20%2316%20%2F%2F%200x20%20%20%20%20%5Cn%20%20%20%2332%20%2F%2F%2010%20%20%20%20%20%20%5Cn%20%20%20%2336%20%2F%2F%20W%20%20%20%20%20%20%20%5Cn%20%24%20%20%20%20%20%2F%2F%2032%20%20%20%20%20%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A0%2C%22end%22%3A159%7D%7D">try it yourself</a></p>
</blockquote>
<p>支持 <code>&amp;</code>、<code>|</code>、<code>~</code>、<code>^</code>、<code>&lt;&lt;</code>、<code>&gt;&gt;</code> 和 <code>&gt;&gt;&gt;</code> 等运算符</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0b10</span> &amp; <span class="number">0b11</span> #<span class="number">2</span> //  <span class="number">0b10</span> </span><br><span class="line"><span class="number">0b01</span> | <span class="number">0b10</span> #<span class="number">2</span> //  <span class="number">0b11</span> </span><br><span class="line"><span class="number">0b01</span> ^ <span class="number">0b11</span> #<span class="number">2</span> //  <span class="number">0b10</span> </span><br><span class="line">      ~<span class="number">0b10</span> #<span class="number">2</span> // -<span class="number">0b11</span> </span><br><span class="line">         ~$ #<span class="number">2</span> //  <span class="number">0b10</span> </span><br><span class="line"> <span class="number">0b10</span>  &lt;&lt; <span class="number">1</span> #<span class="number">2</span> //  <span class="number">0b100</span></span><br><span class="line">    $  &gt;&gt; <span class="number">1</span> #<span class="number">2</span> //  <span class="number">0b10</span> </span><br><span class="line">  $-<span class="number">2</span> &gt;&gt;&gt; <span class="number">1</span> #<span class="number">2</span> //  <span class="number">0b10</span> </span><br><span class="line">-<span class="number">0b10</span>  &gt;&gt; <span class="number">1</span> #<span class="number">2</span> // -<span class="number">0b1</span>  </span><br><span class="line">-<span class="number">0b10</span> &gt;&gt;&gt; <span class="number">1</span> #<span class="number">2</span> //  <span class="number">0b1111111111111111111111111111110</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%220b10%20%26%200b11%20%232%20%2F%2F%20%200b10%20%5Cn0b01%20%7C%200b10%20%232%20%2F%2F%20%200b11%20%5Cn0b01%20%5E%200b11%20%232%20%2F%2F%20%200b10%20%5Cn%20%20%20%20%20%20~0b10%20%232%20%2F%2F%20-0b11%20%5Cn%20%20%20%20%20%20%20%20%20~%24%20%232%20%2F%2F%20%200b10%20%5Cn%200b10%20%20%3C%3C%201%20%232%20%2F%2F%20%200b100%5Cn%20%20%20%20%24%20%20%3E%3E%201%20%232%20%2F%2F%20%200b10%20%5Cn%20%20%24-2%20%3E%3E%3E%201%20%232%20%2F%2F%20%200b10%20%5Cn-0b10%20%20%3E%3E%201%20%232%20%2F%2F%20-0b1%20%20%5Cn-0b10%20%3E%3E%3E%201%20%232%20%2F%2F%20%200b1111111111111111111111111111110%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A124%2C%22end%22%3A124%7D%7D">try it yourself</a></p>
</blockquote>
</details>

<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>基于行号的变量：</p>
<ul>
<li>行首为运算符时在前面自动填入上一行结果</li>
<li>使用 <code>$n</code> 获取第 <code>n</code> 个结果</li>
<li>使用 <code>$-n</code> 获取倒数第 <code>n</code> 个结果（<code>n</code> 为正整数），逻辑类似 JavaScript 中 <code>String</code> 和 <code>Array</code> 的 <code>slice</code> 方法的参数，例如 <code>$-1</code> 为倒数第一个结果</li>
<li>使用 <code>$</code> 获取上一个结果，与 <code>$-1</code> 相同，并且支持各种肤色的 <code>👆🏿</code></li>
</ul>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number"> 2 </span>+<span class="number"> 4 </span>// <span class="number"> 2 </span>+<span class="number"> 4 </span>== 6</span><br><span class="line">     -<span class="number"> 3 </span>// <span class="number"> 6 </span>-<span class="number"> 3 </span>== 3</span><br><span class="line">  $0 /<span class="number"> 2 </span>// <span class="number"> 6 </span>/<span class="number"> 2 </span>== 3</span><br><span class="line">10 % $-1 //<span class="number"> 10 </span>%<span class="number"> 3 </span>== 1</span><br><span class="line">       $ //     <span class="number"> 1 </span>== 1</span><br><span class="line"> 👆🏻 + 👆🏿 // <span class="number"> 1 </span>+<span class="number"> 1 </span>== 2</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20%20%202%20%2B%204%20%2F%2F%20%202%20%2B%204%20%3D%3D%206%5Cn%20%20%20%20%20-%203%20%2F%2F%20%206%20-%203%20%3D%3D%203%5Cn%20%20%240%20%2F%202%20%2F%2F%20%206%20%2F%202%20%3D%3D%203%5Cn10%20%25%20%24-1%20%2F%2F%2010%20%25%203%20%3D%3D%201%5Cn%20%20%20%20%20%20%20%24%20%2F%2F%20%20%20%20%20%201%20%3D%3D%201%5Cn%20%F0%9F%91%86%F0%9F%8F%BB%20%2B%20%F0%9F%91%86%F0%9F%8F%BF%20%2F%2F%20%201%20%2B%201%20%3D%3D%202%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A148%2C%22end%22%3A148%7D%7D">try it yourself</a></p>
</blockquote>
<h3 id="JavaScript-常量、方法"><a href="#JavaScript-常量、方法" class="headerlink" title="JavaScript 常量、方法"></a>JavaScript 常量、方法</h3><p><code>Math</code> 的属性可以作为常量使用：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="attribute">E</span> // <span class="number">2</span>.<span class="number">718281828459045</span></span><br><span class="line"><span class="attribute">PI</span> // <span class="number">3</span>.<span class="number">141592653589793</span></span><br><span class="line"><span class="attribute">GR</span> // <span class="number">0</span>.<span class="number">6180339887498949</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20E%20%2F%2F%202.718281828459045%5CnPI%20%2F%2F%203.141592653589793%5CnGR%20%2F%2F%200.6180339887498949%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A73%2C%22end%22%3A73%7D%7D">try it yourself</a></p>
</blockquote>
<p><code>Math</code> 的方法可以直接作为函数使用：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">min</span>(max(<span class="number">1</span>, <span class="number">2</span>), <span class="number">3</span>) // <span class="number">2</span></span><br><span class="line">       <span class="attribute">pow</span>(<span class="number">2</span>, <span class="number">10</span>) // <span class="number">1024</span></span><br><span class="line">       <span class="attribute">sqrt</span>(<span class="number">1024</span>) // <span class="number">32</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22min(max(1%2C%202)%2C%203)%20%2F%2F%202%20%20%20%5Cn%20%20%20%20%20%20%20pow(2%2C%2010)%20%2F%2F%201024%5Cn%20%20%20%20%20%20%20sqrt(1024)%20%2F%2F%2032%20%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A77%2C%22end%22%3A77%7D%7D">try it yourself</a></p>
</blockquote>
<p><code>Number</code> 的属性可以通过 <code>Number.</code> 形式访问：</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Number</span>.MAX_SAFE_INTEGER <span class="comment">//  9007199254740991</span></span><br><span class="line">  == <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">53</span>) - <span class="number">1</span>     <span class="comment">//  true            </span></span><br><span class="line"><span class="built_in">Number</span>.MIN_SAFE_INTEGER <span class="comment">// -9007199254740991</span></span><br><span class="line">  == - (<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">53</span>) - <span class="number">1</span>) <span class="comment">//  true            </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22Number.MAX_SAFE_INTEGER%20%2F%2F%20%209007199254740991%5Cn%20%20%3D%3D%20pow(2%2C%2053)%20-%201%20%20%20%20%20%2F%2F%20%20true%20%20%20%20%20%20%20%20%20%20%20%20%5CnNumber.MIN_SAFE_INTEGER%20%2F%2F%20-9007199254740991%5Cn%20%20%3D%3D%20-%20(pow(2%2C%2053)%20-%201)%20%2F%2F%20%20true%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A180%2C%22end%22%3A180%7D%7D">try it yourself</a></p>
</blockquote>
<p>Math 的 round() 方法很繁琐，Number 实例的 toFixed() 方法也不好用：</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">```js</span><br><span class="line"><span class="keyword">return</span> Math.round(<span class="number">2000</span> / <span class="number">3</span> * <span class="number">100</span>) / <span class="number">100</span></span><br><span class="line">``` // <span class="number">666.67</span></span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line"><span class="keyword">return</span> Number((<span class="number">2000</span> / <span class="number">3</span>).toFixed(<span class="number">2</span>))</span><br><span class="line">``` // <span class="number">666.66</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%60%60%60js%5Cnreturn%20Math.round(2000%20%2F%203%20*%20100)%20%2F%20100%5Cn%60%60%60%20%2F%2F%20666.67%5Cn%5Cn%60%60%60js%5Cnreturn%20Number((2000%20%2F%203).toFixed(2))%5Cn%60%60%60%20%2F%2F%20666.66%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A118%2C%22end%22%3A118%7D%7D">try it yourself</a></p>
</blockquote>
<p>扩展小数截取函数，第二个参数可以指定取舍的小数点后&#x2F;前的位数：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">_666: <span class="number">2000</span> / <span class="number">3</span>    <span class="comment">// 666.6666666666666</span></span><br><span class="line"><span class="function"><span class="title">round</span><span class="params">(_666, <span class="number">3</span>)</span></span>    <span class="comment">// 666.667          </span></span><br><span class="line"><span class="function"><span class="title">floor</span><span class="params">(_666, <span class="number">2</span>)</span></span>    <span class="comment">// 666.66           </span></span><br><span class="line"><span class="function"><span class="title">ceil</span><span class="params">(_666 / <span class="number">2</span>, <span class="number">1</span>)</span></span> <span class="comment">// 333.4            </span></span><br><span class="line"><span class="function"><span class="title">round</span><span class="params">(_666, <span class="number">0</span>)</span></span>    <span class="comment">// 667              </span></span><br><span class="line"><span class="function"><span class="title">round</span><span class="params">(_666)</span></span>       <span class="comment">// 667              </span></span><br><span class="line"><span class="function"><span class="title">round</span><span class="params">(_666, -<span class="number">1</span>)</span></span>   <span class="comment">// 670              </span></span><br><span class="line"><span class="function"><span class="title">round</span><span class="params">(_666, -<span class="number">2</span>)</span></span>   <span class="comment">// 700              </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22_666%3A%202000%20%2F%203%20%20%20%20%2F%2F%20666.6666666666666%5Cnround(_666%2C%203)%20%20%20%20%2F%2F%20666.667%20%20%20%20%20%20%20%20%20%20%5Cnfloor(_666%2C%202)%20%20%20%20%2F%2F%20666.66%20%20%20%20%20%20%20%20%20%20%20%5Cnceil(_666%20%2F%202%2C%201)%20%2F%2F%20333.4%20%20%20%20%20%20%20%20%20%20%20%20%5Cnround(_666%2C%200)%20%20%20%20%2F%2F%20667%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cnround(_666)%20%20%20%20%20%20%20%2F%2F%20667%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cnround(_666%2C%20-1)%20%20%20%2F%2F%20670%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cnround(_666%2C%20-2)%20%20%20%2F%2F%20700%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A312%2C%22end%22%3A312%7D%7D">try it yourself</a></p>
</blockquote>
<p>扩展的 <code>$sum</code>、<code>$avg</code>、<code>$min</code>、<code>$max</code> 等统计函数，通过参数指定起始和截止行号进行统计计算，参数非常灵活：</p>
<ul>
<li>行号支持负数，类似上面变量</li>
<li>省略第二个参数截止行号，表示统计到前面最后一行</li>
<li>同时省略两个参数起始和截止行号，表示从第 0 行开始统计到前面最后一行</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">           <span class="regexp">//</span> ln: res </span><br><span class="line">         <span class="number">1</span> <span class="regexp">//</span>  <span class="number">0</span>: <span class="number">1</span>   </span><br><span class="line">         <span class="number">2</span> <span class="regexp">//</span>  <span class="number">1</span>: <span class="number">2</span>   </span><br><span class="line">         <span class="number">3</span> <span class="regexp">//</span>  <span class="number">2</span>: <span class="number">3</span>   </span><br><span class="line">   <span class="variable">$sum</span>(<span class="number">0</span>, <span class="number">2</span>)   == <span class="number">6</span> \</span><br><span class="line">&amp;&amp; <span class="variable">$sum</span>(-<span class="number">3</span>, -<span class="number">1</span>) == <span class="number">6</span> \</span><br><span class="line">&amp;&amp; <span class="variable">$sum</span>(<span class="number">0</span>)      == <span class="number">6</span> \</span><br><span class="line">&amp;&amp; <span class="variable">$sum</span>()       == <span class="number">6</span> \</span><br><span class="line">           <span class="regexp">//</span>  <span class="number">3</span>: true</span><br><span class="line"><span class="variable">$avg</span>(<span class="number">0</span>, <span class="number">2</span>) <span class="regexp">//</span>  <span class="number">4</span>: <span class="number">2</span>   </span><br><span class="line"><span class="variable">$min</span>(<span class="number">0</span>, <span class="number">2</span>) <span class="regexp">//</span>  <span class="number">5</span>: <span class="number">1</span>   </span><br><span class="line"><span class="variable">$max</span>(<span class="number">0</span>, <span class="number">2</span>) <span class="regexp">//</span>  <span class="number">6</span>: <span class="number">3</span>   </span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20%20%20%20%20%20%20%20%20%20%2F%2F%20ln%3A%20res%20%5Cn%20%20%20%20%20%20%20%20%201%20%2F%2F%20%200%3A%201%20%20%20%5Cn%20%20%20%20%20%20%20%20%202%20%2F%2F%20%201%3A%202%20%20%20%5Cn%20%20%20%20%20%20%20%20%203%20%2F%2F%20%202%3A%203%20%20%20%5Cn%20%20%20%24sum(0%2C%202)%20%20%20%3D%3D%206%20%5C%5C%5Cn%26%26%20%24sum(-3%2C%20-1)%20%3D%3D%206%20%5C%5C%5Cn%26%26%20%24sum(0)%20%20%20%20%20%20%3D%3D%206%20%5C%5C%5Cn%26%26%20%24sum()%20%20%20%20%20%20%20%3D%3D%206%20%5C%5C%5Cn%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%203%3A%20true%5Cn%24avg(0%2C%202)%20%2F%2F%20%204%3A%202%20%20%20%5Cn%24min(0%2C%202)%20%2F%2F%20%205%3A%201%20%20%20%5Cn%24max(0%2C%202)%20%2F%2F%20%206%3A%203%20%20%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A275%2C%22end%22%3A275%7D%7D">try it yourself</a></p>
</blockquote>
<h3 id="自定义变量"><a href="#自定义变量" class="headerlink" title="自定义变量"></a>自定义变量</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="selector-tag">a</span>: <span class="number">1</span> <span class="comment">// 1</span></span><br><span class="line"> <span class="selector-tag">b</span>: <span class="number">2</span> <span class="comment">// 2</span></span><br><span class="line"><span class="selector-tag">a</span> + <span class="selector-tag">b</span> <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20a%3A%201%20%2F%2F%201%5Cn%20b%3A%202%20%2F%2F%202%5Cna%20%2B%20b%20%2F%2F%203%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A33%2C%22end%22%3A33%7D%7D">try it yourself</a></p>
</blockquote>
<h3 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h3><p>支持自定义函数，可以传递参数，也可以引用外部变量和常量：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">circle_area</span>(r): PI * (r ** <span class="number">2</span>)       </span><br><span class="line"><span class="attribute">circle_area</span>(<span class="number">1</span>) // <span class="number">3</span>.<span class="number">141592653589793</span> </span><br><span class="line"><span class="attribute">circle_area</span>(<span class="number">2</span>) // <span class="number">12</span>.<span class="number">566370614359172</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22circle_area(r)%3A%20PI%20*%20(r%20**%202)%20%20%20%20%20%20%20%5Cncircle_area(1)%20%2F%2F%203.141592653589793%20%5Cncircle_area(2)%20%2F%2F%2012.566370614359172%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A0%2C%22end%22%3A111%7D%7D">try it yourself</a></p>
</blockquote>
<p>支持递归调用和调用其它函数：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// Fibonacci</span></span><br><span class="line">       <span class="built_in">f</span>(<span class="keyword">n</span>): \</span><br><span class="line">  <span class="keyword">n</span> &lt;= 0 ? 0 \</span><br><span class="line">: <span class="keyword">n</span> &lt;= 2 ? 1 \</span><br><span class="line">: (<span class="built_in">f</span>(<span class="keyword">n</span> - 1) + <span class="built_in">f</span>(<span class="keyword">n</span> - 2))</span><br><span class="line"><span class="built_in">f</span>(0) <span class="comment">// 0 </span></span><br><span class="line"><span class="built_in">f</span>(1) <span class="comment">// 1 </span></span><br><span class="line"><span class="built_in">f</span>(2) <span class="comment">// 1 </span></span><br><span class="line"><span class="built_in">f</span>(3) <span class="comment">// 2 </span></span><br><span class="line"><span class="built_in">f</span>(4) <span class="comment">// 3 </span></span><br><span class="line"><span class="built_in">f</span>(5) <span class="comment">// 5 </span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20%20%2F%2F%20Fibonacci%5Cn%20%20%20%20%20%20%20f(n)%3A%20%5C%5C%5Cn%20%20n%20%3C%3D%200%20%3F%200%20%5C%5C%5Cn%3A%20n%20%3C%3D%202%20%3F%201%20%5C%5C%5Cn%3A%20(f(n%20-%201)%20%2B%20f(n%20-%202))%5Cnf(0)%20%2F%2F%200%20%5Cnf(1)%20%2F%2F%201%20%5Cnf(2)%20%2F%2F%201%20%5Cnf(3)%20%2F%2F%202%20%5Cnf(4)%20%2F%2F%203%20%5Cnf(5)%20%2F%2F%205%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A150%2C%22end%22%3A150%7D%7D">try it yourself</a></p>
</blockquote>
<p>并且支持更具语义化的 RORO 形式参数：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">add</span><span class="params">(&#123; a, b &#125;)</span></span>: <span class="selector-tag">a</span> + <span class="selector-tag">b</span></span><br><span class="line"><span class="function"><span class="title">add</span><span class="params">(&#123; a: <span class="number">4</span>, b: <span class="number">5</span> &#125;)</span></span> <span class="comment">// 9</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22add(%7B%20a%2C%20b%20%7D)%3A%20a%20%2B%20b%5Cnadd(%7B%20a%3A%204%2C%20b%3A%205%20%7D)%20%2F%2F%209%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A46%2C%22end%22%3A46%7D%7D">try it yourself</a></p>
</blockquote>
<h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><p>尽管 ScriptCalculator 已足够强大，但有时仍然无法满足复杂的需求。例如在自定义函数内使用临时变量、数组、对象甚至正则，以及步骤复杂的计算逻辑。为了避免重返 Chrome 控制台，ScriptCalculator 支持内嵌 JavaScript 表达式和代码块。</p>
<p>JavaScript 表达式可以直接内嵌到算式当中：</p>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">1 </span>+ `<span class="string">&quot;x&quot;</span>.length`</span><br></pre></td></tr></table></figure>

<p>JavaScript 代码块中可以编写计算代码，在末尾用 <code>return</code> 返回结果：</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```js</span><br><span class="line">let<span class="built_in"> array </span>= [1, 2, 3];<span class="built_in"></span></span><br><span class="line"><span class="built_in">return </span>array.length;</span><br><span class="line">``` // 3</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%60%60%60js%5Cnlet%20array%20%3D%20%5B1%2C%202%2C%203%5D%3B%5Cnreturn%20array.length%3B%5Cn%60%60%60%20%2F%2F%203%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A59%2C%22end%22%3A59%7D%7D">try it yourself</a></p>
</blockquote>
<p>JavaScript 代码块中还可以用 <code>return</code> 返回带有 <code>name</code> 的自定义函数，然后在代码块外面使用 <code>name</code> 调用：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```js</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">function</span> <span class="title">double</span>(x) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">x</span> * <span class="number">2</span>;          </span><br><span class="line">&#125;;                         </span><br><span class="line">```</span><br><span class="line">double(<span class="number">1</span>) // <span class="number">2</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%60%60%60js%5Cnreturn%20function%20double(x)%20%7B%5Cn%20%20%20%20return%20x%20*%202%3B%20%20%20%20%20%20%20%20%20%20%5Cn%7D%3B%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%60%60%60%5Cndouble(1)%20%2F%2F%202%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A0%2C%22end%22%3A109%7D%7D">try it yourself</a></p>
</blockquote>
<h3 id="空白、注释"><a href="#空白、注释" class="headerlink" title="空白、注释"></a>空白、注释</h3><ul>
<li>支持任意的空格，便于纵向对齐</li>
<li>支持任意的空行，空行不影响结果行号</li>
<li>行尾加 <code>\</code> 可以折行，特别是自定义复杂的函数时可以避免一行过长</li>
<li>支持 <code>#</code> 和 <code>//</code> 两种形式的注释</li>
</ul>
<h2 id="设置、按钮"><a href="#设置、按钮" class="headerlink" title="设置、按钮"></a>设置、按钮</h2><ul>
<li>decimal：全局结果精确位数</li>
<li>rounding：全局小数截取方法</li>
<li>underline：给强迫症删除空格用</li>
<li>reset：重置设置</li>
<li>copy：拷贝 <code>注释 + 算式 + 结果</code></li>
</ul>
<h2 id="辅助功能"><a href="#辅助功能" class="headerlink" title="辅助功能"></a>辅助功能</h2><ul>
<li>行号：有计算结果的行显示行号，可用于 <code>$ + 行号</code> 获取指定行结果</li>
<li>标尺：方便对齐格式化脚本</li>
<li>撤销、重做：支持默认的撤销、重做功能</li>
<li>快捷键：</li>
<li><kbd>control</kbd>+<kbd>u</kbd> 单词或选中文本大写</li>
<li><kbd>control</kbd>+<kbd>shift</kbd>+<kbd>u</kbd> 单词或选中文本小写</li>
<li><kbd>control</kbd>+<kbd>c</kbd> 首字母大写</li>
<li><kbd>control</kbd>+<kbd>shift</kbd>+<kbd>c</kbd> 首字母小写</li>
<li>URL Hash：URL Hash 中包含完整计算内容和设置，可前进&#x2F;后退、刷新不丢数据，拷贝 URL 可以分享或备份，重新打开后 100% 还原</li>
</ul>
<h2 id="已知问题"><a href="#已知问题" class="headerlink" title="已知问题"></a>已知问题</h2><ul>
<li><p>暂不支持 <code>BigInt</code></p>
</li>
<li><p>“行首为运算符时自动在前面填入上一行结果”导致正负号存在歧义</p>
</li>
</ul>
<p>例如：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">      <span class="regexp">//</span> exp   got</span><br><span class="line">a:  <span class="number">1</span> <span class="regexp">//</span>  <span class="number">1</span>    <span class="number">1</span>  </span><br><span class="line">b: -<span class="number">1</span> <span class="regexp">//</span> -<span class="number">1</span>    <span class="number">0</span>  </span><br><span class="line">c:  <span class="number">1</span> <span class="regexp">//</span>  <span class="number">1</span>    <span class="number">1</span>  </span><br><span class="line">d: +<span class="number">1</span> <span class="regexp">//</span>  <span class="number">1</span>    <span class="number">2</span>  </span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22%20%20%20%20%20%20%2F%2F%20exp%20%20%20got%5Cna%3A%20%201%20%2F%2F%20%201%20%20%20%201%20%20%5Cnb%3A%20-1%20%2F%2F%20-1%20%20%20%200%20%20%5Cnc%3A%20%201%20%2F%2F%20%201%20%20%20%201%20%20%5Cnd%3A%20%2B1%20%2F%2F%20%201%20%20%20%202%20%20%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A0%2C%22end%22%3A95%7D%7D">try it yourself</a></p>
</blockquote>
<p>解决办法是在带正负号的数字外加括号、或在带正负号的数字前换行：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>:   <span class="number">1</span>  //  <span class="number">1</span></span><br><span class="line"><span class="attribute">b</span>: (-<span class="number">1</span>) // -<span class="number">1</span></span><br><span class="line"><span class="attribute">c</span>:   <span class="number">1</span>  //  <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">d</span>:  +<span class="number">1</span>  //  <span class="number">1</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><a href="https://iwill.im/static/ScriptCalculator.html#%7B%22script%22%3A%22a%3A%20%20%201%20%20%2F%2F%20%201%5Cnb%3A%20(-1)%20%2F%2F%20-1%5Cnc%3A%20%20%201%20%20%2F%2F%20%201%5Cn%5Cnd%3A%20%20%2B1%20%20%2F%2F%20%201%5Cn%22%2C%22selection%22%3A%7B%22start%22%3A57%2C%22end%22%3A57%7D%7D">try it yourself</a></p>
</blockquote>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/js/">js</a>, <a href="/tags/calculator/">calculator</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">Comments</h1>

  
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:iwill.im">
  </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/blog/">blog</a><small>2</small></li>
  
    <li><a href="/tags/calculator/">calculator</a><small>1</small></li>
  
    <li><a href="/tags/class/">class</a><small>1</small></li>
  
    <li><a href="/tags/domain/">domain</a><small>1</small></li>
  
    <li><a href="/tags/github-pages/">github-pages</a><small>1</small></li>
  
    <li><a href="/tags/hexo/">hexo</a><small>2</small></li>
  
    <li><a href="/tags/js/">js</a><small>2</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2022 iwill
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'minglq';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>